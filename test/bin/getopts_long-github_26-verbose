#!/usr/bin/env bash

TOPDIR="$(cd "$(dirname "${0}")"/../.. && pwd)"
# shellcheck disable=SC1090
source "${TOPDIR}/lib/getopts_long.bash"

while getopts_long 'to:v: toggle option: variable: -toggle -option:' OPTKEY; do
    case ${OPTKEY} in
        't'|'toggle'|'-toggle')
            printf 'toggle triggered'
            ;;
        '-'|'o'|'option'|'-option')
            printf 'option supplied'
            ;;
        'v'|'variable')
            printf 'value supplied'
            ;;
        '?')
            printf "INVALID OPTION or MISSING ARGUMENT"
            ;;
        *)
            printf "NEVER REACHED"
            ;;
    esac
    printf ' -- '
    declare -p OPTARG 2>&1 | grep -oe 'OPTARG.*'
done

shift $(( OPTIND - 1 ))

echo "OPTERR: ${OPTERR}"
echo "OPTKEY: ${OPTKEY}"
echo "OPTARG: ${OPTARG}"
echo "OPTIND: ${OPTIND}"
echo "\$@: ${*}"
